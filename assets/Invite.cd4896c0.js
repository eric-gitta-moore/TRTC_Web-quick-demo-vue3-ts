import{_ as L,d as N,u as M,a as S,g as c,E as d,T as i,b as $,c as B,e as O,f as b,w as l,o as m,h as u,i as r,t as C,j as g,k as R,l as A,r as D,F as P,n as T,p as Y,m as F}from"./index.8a3d58f9.js";const j=n=>(Y("data-v-233e5e1e"),n=n(),F(),n),K={class:"invite"},q={class:"share-link"},z={class:"alert"},G={style:{"padding-top":"10px"}},H=j(()=>r("div",{id:"local",style:{"margin-top":"20px"}},null,-1)),J={class:"remote-container"},Q=["id"],W=N({__name:"Invite",setup(n){const{t:_}=M(),a=S(),E=parseInt(c("sdkAppId"),10),f=c("userId"),v=c("userSig"),I=parseInt(c("roomId"),10),w={url:window.location.href.split("?")[0]};window.history.pushState(w,"","index.html#/invite"),navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(e=>{e.getTracks().forEach(t=>{t.stop()})}).catch(()=>{d({message:_("permit"),type:"error"})}),(!E||!f||!v||!I)&&d.error(_("check"));const o=i.create();async function x(){try{await o.enterRoom({roomId:I,sdkAppId:E,userId:f,userSig:v}),o.on(i.EVENT.REMOTE_VIDEO_AVAILABLE,h),o.on(i.EVENT.REMOTE_VIDEO_UNAVAILABLE,y),await o.startLocalAudio(),await o.startLocalVideo({view:"local",option:{profile:"1080p"}})}catch(e){d({message:e.message,type:"error"})}}async function h(e){console.log("[demo] Video Available",e);const{userId:t,streamType:s}=e;try{s===i.TYPE.STREAM_TYPE_MAIN?(a.invitedRemoteUsers.push(`${t}_main`),await T(),await o.startRemoteVideo({userId:t,streamType:s,view:`${t}_main`})):(a.invitedRemoteUsers.push(`${t}_screen`),await T(),o.startRemoteVideo({userId:t,streamType:s,view:`${t}_screen`})),console.log(`startRemoteVideo success: [${t}]`)}catch(p){console.log(`startRemoteVideo failed: [${t}], error: ${p.message}`)}}async function y(e){console.log("[demo] Video Unavailable",e);const{streamType:t}=e;o.stopRemoteVideo({userId:e.userId,streamType:t}),t===i.TYPE.STREAM_TYPE_MAIN?a.invitedRemoteUsers=a.invitedRemoteUsers.filter(s=>s!==`${e.userId}_main`):a.invitedRemoteUsers=a.invitedRemoteUsers.filter(s=>s!==`${e.userId}_screen`)}async function U(){try{o.off(i.EVENT.REMOTE_VIDEO_AVAILABLE,h),o.off(i.EVENT.REMOTE_VIDEO_UNAVAILABLE,y),await o.exitRoom(),await o.stopLocalVideo(),await o.stopLocalAudio()}catch(e){d({message:`Exit room failed. Error: ${e.message}`,type:"error"})}}return(e,t)=>{const s=$,p=B,k=O;return m(),b(k,{style:{padding:"0 10px 40px 10px"}},{default:l(()=>[u(p,{md:{span:18,offset:3},sm:{span:24}},{default:l(()=>[r("div",K,[r("div",q,[r("div",z,C(g(_)("inviteUrl")),1)])]),r("div",G,[u(s,{type:"primary",onClick:x},{default:l(()=>[R(" Enter ")]),_:1}),u(s,{type:"primary",onClick:U},{default:l(()=>[R(" Exit ")]),_:1})]),H,r("div",J,[(m(!0),A(P,null,D(g(a).invitedRemoteUsers,V=>(m(),A("div",{key:V,id:V,style:{"margin-top":"20px"}},null,8,Q))),128))])]),_:1})]),_:1})}}});var Z=L(W,[["__scopeId","data-v-233e5e1e"]]);export{Z as default};
